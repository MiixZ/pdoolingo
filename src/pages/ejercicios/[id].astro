---
import type { Ejercicio } from "@interfaces/Ejercicio";
import EjercicioLayout from "@layouts/EjercicioLayout.astro";
import { getEjercicios, getEjercicio } from "@services/ejercicios.ts";
import { getUsuarioID } from "@services/usuario";

export async function getStaticPaths() {
  const data = await getEjercicios();
  const ejercicios = data.data;
  return ejercicios.map((ejercicio: Ejercicio) => ({
    params: { id: ejercicio.id.toString() },
  }));
}

const { id } = Astro.params;
const ejercicio = await getEjercicio(id);

const url = new URL(Astro.request.url);
const id_usuario = url.searchParams.get("id_usuario");
const usuario = await getUsuarioID(id_usuario);
---

<EjercicioLayout
  title="PDOOLingo - Ejercicio"
  ejercicio={ejercicio}
  usuario={usuario}
/>
